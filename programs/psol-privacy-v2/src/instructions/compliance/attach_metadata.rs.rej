--- programs/psol-privacy-v2/src/instructions/compliance/attach_metadata.rs
+++ programs/psol-privacy-v2/src/instructions/compliance/attach_metadata.rs
@@ -1,10 +1,14 @@
 use anchor_lang::prelude::*;
 use crate::state::{PrivacyPoolV2, ComplianceConfig};
 use crate::error::PrivacyErrorV2;
+use crate::utils::validate_metadata_uri;
 
 pub fn handle_attach_metadata(
     ctx: Context<AttachMetadata>,
     metadata_uri: String,
 ) -> Result<()> {
+    // Validate metadata URI
+    validate_metadata_uri(&metadata_uri)?;
+    
     let pool = &ctx.accounts.pool;
     let compliance = &ctx.accounts.compliance;
